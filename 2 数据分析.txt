2 数据分析

- 主要使用数据透视表工具，是Excel中提供的对数据进行快速分类，汇总的一种交互式工具
- 前提是在数据处理环节生成符合数据规范的一维表

2.1 对比分析
- 将两个或两个以上数据进行比较，分析其差异性，从而揭示事务发展变化的情况和规律性

- 以日期对比为例进行介绍

1）日期分组
- 统计每个月份的用户注册数
选取号码库的“号码”和“注册时间”列 - Insert - PivotTable - 选取号码，拖到Values - 显示号码的总数
- 注册日期拉到Row - 显示每日的注册用户数
- 右键点击任一日期 - Group - 选取月和年（由于数据跨年所以要选取年）

2）计算环比
- 再将号码拉到汇总区域- 生成新的一列月合计 - 右键点击上述列任一字段 - Value Field Settings - show value as - % Difference From - base field "注册时间" - base item "previous" - 得到环比结果

3）计算同比
- 再将号码拉到汇总区域- 生成新的一列月合计 - 右键点击上述列任一字段 - Value Field Settings - show value as - % Difference From - base field "years" - base item "previous" - 得到环比结果

2.2 结构分析
- 在分组的基础上，计算各个组成部分所占比重，进而分析总体内部特征的一种分析方法， 如市场占有率的计算

1） 定性分组
- 按事物属性划分，如性别
- 对用户是否使用微信进行分组

选取号码库的“号码”和“注册时间”和“微信”列 - Insert - PivotTable - 选取号码字段，拖到Values - 显示号码的总数
- 选取微信字段，拖到Row - 显示是、否列行总数

2）占比计算
右键点击Count of 号码字段任一值 - Value Field Settings - show value as - % of column Total - 显示占比

3）显示饼图
Insert - chart - 饼图

4）增加时间维度
“微信”从行标签拉到列标签 - “注册时间”拉到行标签 - 右键点击‘是’、‘否’字段内容 - show value as - % of row Total
- Column lable取消Blank列 - 点击注册时间列 - group - 选取‘年’，‘月’ - 把'years'拉到筛选器 - 在筛选器中点击2012 - 得到2012的用户结构趋势变化

5）插入图表
Insert - 百分比堆积柱形图 100% stacked diagram

- 如果有其他维度如地区，也可以加入，例如分析各地区用户结构的差异

2.3 分布分析
-- 根据分析目的，对数值型数据进行等距或不等距的分组。例如消费分布，收入分布，年龄分布分析

1）定量分组
方法一、VLOOKUP
- 对用户的月消费进行分组分析
VLOOKUP产生月消费分组-Insert-PivotTable-号码拉到汇总-消费分组拉到Row-取消Blank-显示不同区间的号码数

方法二、数据透视表
选取包括号码列到月消费列-Insert-PivotTable-号码拉到汇总-月消费拉到Row-取消Blank--显示不同区间的号码数-点击Cluster Column生成柱状图

数据透视表的优点是简单快速，但无法实现不等距分组，VLOOKUP可以实现不等距分组，实际工作中一般用数据透视表先了解数据分组情况，再用VLOOKUP来实现适合我们需要的分组。

作业4：
-如何实现用户购买日期间隔分布，数据存在一个用户多条购买日期的记录？
0. 按照用户ID和购买日期排序
1. 利用用户名+0和1作为两列Key
2. 用VLOOKUP返回第二列Key与第一列Key比较获得的日期。此时每个用户ID最后一个值是匹配不到的。
3. 用DATEDIF函数返回间隔天数（直接用减法也可以）
4. 对间隔天数用数据透视表进行分组， GROUP

2.4 交叉分析

-- 用于分析两个或两个以上分组变量间的关系，以交叉表的形式进行变量表间的对比分析
-- 可以是三个或更多分组变量，但是分组变量越多，越难看出关系，重点不突出。

案例：根据消费、流量两个维度对某通信公司用户数进行细分。
1. VLOOKUP按照实际使用流量给用户流量使用情况分组（高，中，低）
2. VLOOKUP按照实际消费给用户消费情况分组（高，中，低）
3. 根据以上两个标签制作交叉表。选取全部列，数据透视表-把号码拉到汇总，把消费拉到Row，流量拉到column，产生交叉表，包括9个流量区间的用户数量。
4. 点击高流量、低消费用户单元则列出全部高流量、低消费用户列表，可以做进一步分析。为什么这么多高流量低消费的？
5. 把Column框的流量换成品牌，则可以看到不同品牌的高中低消费情况
6. 把消费换成手机通信品牌，则可以看到不同品牌使用手机型号的情况

2.5 矩阵分析
--根据事物的两个重要属性作为分析的依据，进行关联分析，找出问题根源得分析方法，如某百货公司的商品评估矩阵，利润率高、低，销量高、低。

案例：根据消费、流量两个维度，分析某通信公司各大区用户质量。
1. 选取全部列，数据透视表
2. 流量和消费拉到值框，选平均值
3. 区域拉到列，即生成各区流量和消费平均值的二维表
4. 生成散点图。
- 选择数据区域（不要选表头）- 选择散点图 - 点击Delete删除网格线 - 点击横纵轴，设置坐标轴格式，Axis value设为整体平均值
- 选取横纵轴标签 - Label - Label Position设置为None。
- 添加标签。点击散点 - 添加标签 - Format Label - Above - Data from cells - 选取区域值对应范围

2.6 多表关联分析
- 根据各表共有的关键字段Key进行数据记录的一一对应，类似前述的VLOOLUP功能，现在不需要使用VLOOKUP就可以匹配，2013以上版本有

步骤
1. 将数据表添加至“数据模型”中
2. 插入数据透视表
3. 建立数据表之间的关系
4. 拖动字段进行分析

案例：根据地区、通信品牌两个维度统计消费用户数

表1： 消费记录， 有省份字段没有地区字段 （事实表，省份类似FK）
表2： 地区维表，省份和地区 （维表）
通过公有的省份字段关联，获取地区

1. 将数据表添加至“数据模型”中：
- 选取“数据表” - Insert - Table - OK；选取“地区表” - Insert - Table - OK；
2. 插入数据透视表：
- Insert - PivotTable - More Tables - 透视表里面包括Tabel1和Table2两张表
3. 建立数据表之间的关系
- Analyze菜单 - Relationship - 表一/省份 - 表二/省份 - OK
4. 拖动字段进行分析
- 号码到值，地区到ROW, 品牌到Column

作业5 - 根据地区、通信品牌两个维度统计微信消费用户数，增加一个筛选项，是否开通微信的用户 
- 选取“号码库”- Insert - Table - OK
- More tables - 透视表里面包括Tabel1，Table2，Table3 三张表
- 建立另一个关系：Analyze菜单 - Relationship - 表一/号码 - 表三/号码 - OK
- 拖动字段进行分析：Table3微信字段拖动到Filter，选取是/否/All，进行过滤

2.7 RFM分析
- 是根据客户活跃程度和交易金额贡献，进行客户价值细分的一种方法：
R（Recency)近度：客户最近一次购买时间的间隔，R越大，表示客户越久未发生交易，R越小，表示客户越近有交易发生
F(Frequency)频度：客户在最近一段时间内购买的次数， F越大，表示客户交易越频繁，F越小，表示客户不够活跃
M（Monetary)额度：客户在最近一段时间内购买的金额，M越大，表示客户价值越高，M越小，表示客户价值越低

三维交叉分析
1. 获取用户最近一次交易时间，交易次数，平均交易金额
PivotTable - 选取全部四列，客户ID在ROW，值选Average of交易金额；Count of 交易ID；Max of 交易时间。
2. 将以上透视表数据拷贝到另一个工作表，通过VLOOKUP确定R_S，F_S，M_S
3. 八大类的用户各有多少？
- 2（高/低）× 2（高/低）× 2（高/低）
- 选取上述工作表所有列，数据透视表，用户ID拖到值，M, F, R 拖到ROW
- 选取设计-报表布局-以表格形式显示-报表布局-重复所有项目标签-分类汇总-不显示分类汇总-取消空白 - 形成三个指标的排列组合及对应的客户数



















